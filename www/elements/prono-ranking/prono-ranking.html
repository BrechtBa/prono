
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/iron-flex-layout/classes/iron-flex-layout.html">

<link rel="import" href="../../elements/default-dialog/default-dialog.html">
<link rel="import" href="../../elements/avatar-image/avatar-image.html">

<dom-module id="prono-ranking">
	<template>

		<style>
			:host{
				display: block;
				width: 100%;
			}
			paper-card{
      			margin-bottom: 5px;
				cursor: pointer;
				padding: 10px;
				background: var(--background-secondary-color);
				color: var(--text-secondary-color);
    		}
			paper-card.me{
				margin-left: 5px;
				margin-right: -5px;
			}
			.ranking{
				width: 30px;
			}
			.name{
				padding: 10px;
			}
			.points{
				width: 40px;
			}
			
		</style>

		<template is="dom-repeat" items="{{users}}" as="item" sort="_sortUsers">
			<paper-card elevation="2" class$="horizontal layout center {{userClass(item,user)}}" on-tap="showDetails">
				<div class="ranking">{{ranking(index)}}</div>
				<avatar-image class="avatar" user="{{item}}"></avatar-image>
				<div class="flex name">{{item.name}}</div>
				<div class="points">{{item.points}}</div>
			</paper-card>
		</template>

		<default-dialog id="pointDetails">
			temp
		</default-dialog>
	

	</template>

	<script>
		Polymer({
			is: 'prono-ranking',
			properties: {
				token: {
					type: 'String',
					value: ''
				},
				users: {
					type: 'Array',
					value: []
				},
				user: {
					type: 'Object'
				}
			},
			userClass: function(user1,user2){
				var cl = '';
				if(user1.user_id == user2.user_id){
					cl = 'me';
				}
				return cl;
			},
			ranking: function(index){
				return index+1;
			},
			_getAvatar: function(src){
				if(src==''){
					return ''
				}
				else{
					return src;
				}
			},	
			_sortUsers: function(a,b){  
				if(parseFloat(a.points) > parseFloat(b.points)){
					return -1;
				}
				else if(parseFloat(a.points) < parseFloat(b.points)){
					return 1;
				}
				else{
					return 0;
				}
			}
		});
	</script>

</dom-module>
